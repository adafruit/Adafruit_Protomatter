<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Adafruit Protomatter: core.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Adafruit Protomatter
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">core.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="core_8h_source.html">core.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arch_8h_source.html">arch.h</a>&quot;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae4ad109606de0143863f6fa67bc65a7c"><td class="memItemLeft" align="right" valign="top"><a id="ae4ad109606de0143863f6fa67bc65a7c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#ae4ad109606de0143863f6fa67bc65a7c">_PM_MAX_REFRESH_HZ</a>&#160;&#160;&#160;250</td></tr>
<tr class="memdesc:ae4ad109606de0143863f6fa67bc65a7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max matrix refresh rate. <br /></td></tr>
<tr class="separator:ae4ad109606de0143863f6fa67bc65a7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf9fbe59de37b1be30ca970d0fbb5b2a"><td class="memItemLeft" align="right" valign="top"><a id="acf9fbe59de37b1be30ca970d0fbb5b2a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#acf9fbe59de37b1be30ca970d0fbb5b2a">_PM_ROW_DELAY</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:acf9fbe59de37b1be30ca970d0fbb5b2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delay time between row address line changes (ms) <br /></td></tr>
<tr class="separator:acf9fbe59de37b1be30ca970d0fbb5b2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5baa3832df0a853a8ecc25d616d82671"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#a5baa3832df0a853a8ecc25d616d82671">_PM_clearReg</a>(x)</td></tr>
<tr class="memdesc:a5baa3832df0a853a8ecc25d616d82671"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear non-RGB-data-or-clock control line (<a class="el" href="struct___p_m__pin.html">_PM_pin</a> type)  <a href="#a5baa3832df0a853a8ecc25d616d82671">More...</a><br /></td></tr>
<tr class="separator:a5baa3832df0a853a8ecc25d616d82671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88096016bcf17f3a923c32ce76981b57"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#a88096016bcf17f3a923c32ce76981b57">_PM_setReg</a>(x)</td></tr>
<tr class="memdesc:a88096016bcf17f3a923c32ce76981b57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set non-RGB-data-or-clock control line (<a class="el" href="struct___p_m__pin.html">_PM_pin</a> type)  <a href="#a88096016bcf17f3a923c32ce76981b57">More...</a><br /></td></tr>
<tr class="separator:a88096016bcf17f3a923c32ce76981b57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc993d1618986d61985428f06a8c69a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#afcc993d1618986d61985428f06a8c69a">PEW</a></td></tr>
<tr class="memdesc:afcc993d1618986d61985428f06a8c69a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bitbang one set of RGB data bits to matrix.  <a href="#afcc993d1618986d61985428f06a8c69a">More...</a><br /></td></tr>
<tr class="separator:afcc993d1618986d61985428f06a8c69a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c8c13eb68adf4548f753041d6b48386"><td class="memItemLeft" align="right" valign="top"><a id="a6c8c13eb68adf4548f753041d6b48386"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#a6c8c13eb68adf4548f753041d6b48386">PEW_UNROLL</a>&#160;&#160;&#160;<a class="el" href="core_8c.html#afcc993d1618986d61985428f06a8c69a">PEW</a> <a class="el" href="core_8c.html#afcc993d1618986d61985428f06a8c69a">PEW</a> <a class="el" href="core_8c.html#afcc993d1618986d61985428f06a8c69a">PEW</a> <a class="el" href="core_8c.html#afcc993d1618986d61985428f06a8c69a">PEW</a> <a class="el" href="core_8c.html#afcc993d1618986d61985428f06a8c69a">PEW</a> <a class="el" href="core_8c.html#afcc993d1618986d61985428f06a8c69a">PEW</a> <a class="el" href="core_8c.html#afcc993d1618986d61985428f06a8c69a">PEW</a> <a class="el" href="core_8c.html#afcc993d1618986d61985428f06a8c69a">PEW</a></td></tr>
<tr class="memdesc:a6c8c13eb68adf4548f753041d6b48386"><td class="mdescLeft">&#160;</td><td class="mdescRight">8-way PEW unroll <br /></td></tr>
<tr class="separator:a6c8c13eb68adf4548f753041d6b48386"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2382fb4f3e05345517f48ccfe8327da6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="core_8h.html#af659eb7a92f2ae47fac607db2eca4bc5">ProtomatterStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#a2382fb4f3e05345517f48ccfe8327da6">_PM_init</a> (<a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *core, uint16_t bitWidth, uint8_t bitDepth, uint8_t rgbCount, uint8_t *rgbList, uint8_t addrCount, uint8_t *addrList, uint8_t clockPin, uint8_t latchPin, uint8_t oePin, bool doubleBuffer, void *timer)</td></tr>
<tr class="memdesc:a2382fb4f3e05345517f48ccfe8327da6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize values in <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure.  <a href="#a2382fb4f3e05345517f48ccfe8327da6">More...</a><br /></td></tr>
<tr class="separator:a2382fb4f3e05345517f48ccfe8327da6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb36fc4f875be610434118739356fb5c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="core_8h.html#af659eb7a92f2ae47fac607db2eca4bc5">ProtomatterStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#abb36fc4f875be610434118739356fb5c">_PM_begin</a> (<a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *core)</td></tr>
<tr class="memdesc:abb36fc4f875be610434118739356fb5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate display buffers and populate additional elements of a Protomatter matrix.  <a href="#abb36fc4f875be610434118739356fb5c">More...</a><br /></td></tr>
<tr class="separator:abb36fc4f875be610434118739356fb5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d7c90c3c5b83a38da3fd522f68abd7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#a98d7c90c3c5b83a38da3fd522f68abd7">_PM_stop</a> (<a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *core)</td></tr>
<tr class="memdesc:a98d7c90c3c5b83a38da3fd522f68abd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable (but do not deallocate) a Protomatter matrix. Disables matrix by setting OE pin HIGH and writing all-zero data to matrix shift registers, so it won't halt with lit LEDs.  <a href="#a98d7c90c3c5b83a38da3fd522f68abd7">More...</a><br /></td></tr>
<tr class="separator:a98d7c90c3c5b83a38da3fd522f68abd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace9b720e159e7ac6863915ee7e889768"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#ace9b720e159e7ac6863915ee7e889768">_PM_resume</a> (<a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *core)</td></tr>
<tr class="memdesc:ace9b720e159e7ac6863915ee7e889768"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start or restart a matrix. Initialize counters, configure and start timer.  <a href="#ace9b720e159e7ac6863915ee7e889768">More...</a><br /></td></tr>
<tr class="separator:ace9b720e159e7ac6863915ee7e889768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf89afcb7761b40e2cfa65a70bce5675"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#adf89afcb7761b40e2cfa65a70bce5675">_PM_free</a> (<a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *core)</td></tr>
<tr class="memdesc:adf89afcb7761b40e2cfa65a70bce5675"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate memory associated with <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure (e.g. screen data, pin lists for data and rows). Does not deallocate the structure itself.  <a href="#adf89afcb7761b40e2cfa65a70bce5675">More...</a><br /></td></tr>
<tr class="separator:adf89afcb7761b40e2cfa65a70bce5675"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb462880fa61b8dcc1bee712a9be2f58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#abb462880fa61b8dcc1bee712a9be2f58">_PM_row_handler</a> (<a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *core)</td></tr>
<tr class="memdesc:abb462880fa61b8dcc1bee712a9be2f58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix "row handler" that's called by the timer interrupt. Handles row address lines and issuing data to matrix.  <a href="#abb462880fa61b8dcc1bee712a9be2f58">More...</a><br /></td></tr>
<tr class="separator:abb462880fa61b8dcc1bee712a9be2f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d7939d31d18e0763fcdf47ad5b298c"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core_8c.html#a00d7939d31d18e0763fcdf47ad5b298c">_PM_getFrameCount</a> (<a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *core)</td></tr>
<tr class="memdesc:a00d7939d31d18e0763fcdf47ad5b298c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns current value of frame counter and resets its value to zero. Two calls to this, timed one second apart (or use math with other intervals), can be used to get a rough frames-per-second value for the matrix (since this is difficult to estimate beforehand).  <a href="#a00d7939d31d18e0763fcdf47ad5b298c">More...</a><br /></td></tr>
<tr class="separator:a00d7939d31d18e0763fcdf47ad5b298c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Part of Adafruit's Protomatter library for HUB75-style RGB LED matrices.</p>
<p>Adafruit invests time and resources providing this open source code, please support Adafruit and open-source hardware by purchasing products from Adafruit!</p>
<p>Written by Phil "Paint Your Dragon" Burgess and Jeff Epler for Adafruit Industries, with contributions from the open source community.</p>
<p>BSD license, all text here must be included in any redistribution. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a5baa3832df0a853a8ecc25d616d82671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5baa3832df0a853a8ecc25d616d82671">&#9670;&nbsp;</a></span>_PM_clearReg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _PM_clearReg</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(*(<span class="keyword">volatile</span> <a class="code" href="arch_8h.html#ac5bd6ee8eef7d07a9048da3c7e1f23b0">_PM_PORT_TYPE</a> *)((x).clearReg) =                                 \</div><div class="line">       ((x).bit))</div><div class="ttc" id="arch_8h_html_ac5bd6ee8eef7d07a9048da3c7e1f23b0"><div class="ttname"><a href="arch_8h.html#ac5bd6ee8eef7d07a9048da3c7e1f23b0">_PM_PORT_TYPE</a></div><div class="ttdeci">#define _PM_PORT_TYPE</div><div class="ttdoc">PORT register size/type. </div><div class="ttdef"><b>Definition:</b> arch.h:1419</div></div>
</div><!-- fragment -->
<p>Clear non-RGB-data-or-clock control line (<a class="el" href="struct___p_m__pin.html">_PM_pin</a> type) </p>

</div>
</div>
<a id="a88096016bcf17f3a923c32ce76981b57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88096016bcf17f3a923c32ce76981b57">&#9670;&nbsp;</a></span>_PM_setReg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _PM_setReg</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(*(<span class="keyword">volatile</span> <a class="code" href="arch_8h.html#ac5bd6ee8eef7d07a9048da3c7e1f23b0">_PM_PORT_TYPE</a> *)((x).setReg) =                                   \</div><div class="line">       ((x).bit))</div><div class="ttc" id="arch_8h_html_ac5bd6ee8eef7d07a9048da3c7e1f23b0"><div class="ttname"><a href="arch_8h.html#ac5bd6ee8eef7d07a9048da3c7e1f23b0">_PM_PORT_TYPE</a></div><div class="ttdeci">#define _PM_PORT_TYPE</div><div class="ttdoc">PORT register size/type. </div><div class="ttdef"><b>Definition:</b> arch.h:1419</div></div>
</div><!-- fragment -->
<p>Set non-RGB-data-or-clock control line (<a class="el" href="struct___p_m__pin.html">_PM_pin</a> type) </p>

</div>
</div>
<a id="afcc993d1618986d61985428f06a8c69a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcc993d1618986d61985428f06a8c69a">&#9670;&nbsp;</a></span>PEW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEW</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">*<span class="keyword">set</span> = *data++; <span class="comment">/* Set RGB data high */</span>                                      \</div><div class="line">  _PM_clockHoldLow;                                                            \</div><div class="line">  *set_full = clock; <span class="comment">/* Set clock high */</span>                                      \</div><div class="line">  _PM_clockHoldHigh;                                                           \</div><div class="line">  *clear_full = rgbclock;                                                      \</div><div class="line">  <span class="comment">/* Clear RGB data + clock */</span></div></div><!-- fragment -->
<p>Bitbang one set of RGB data bits to matrix. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2382fb4f3e05345517f48ccfe8327da6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2382fb4f3e05345517f48ccfe8327da6">&#9670;&nbsp;</a></span>_PM_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="core_8h.html#af659eb7a92f2ae47fac607db2eca4bc5">ProtomatterStatus</a> _PM_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *&#160;</td>
          <td class="paramname"><em>core</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>bitWidth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>bitDepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rgbCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>rgbList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>addrCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>addrList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>clockPin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>latchPin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>oePin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>doubleBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>timer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize values in <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>Pointer to <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure. </td></tr>
    <tr><td class="paramname">bitWidth</td><td>Total width of RGB matrix chain, in pixels. Usu. some multiple of 32, but maybe exceptions. </td></tr>
    <tr><td class="paramname">bitDepth</td><td>Color "depth" in bitplanes, determines range of shades of red, green and blue. e.g. passing 4 bits = 16 shades ea. R,G,B = 16x16x16 = 4096 colors. </td></tr>
    <tr><td class="paramname">rgbCount</td><td>Number of "sets" of RGB data pins, each set containing 6 pins (2 ea. R,G,B). Typically 1, indicating a single matrix (or matrix chain). In theory (but not yet extensively tested), multiple sets of pins can be driven in parallel, up to 5 on some devices (if the hardware design provides all those bits on one PORT). </td></tr>
    <tr><td class="paramname">rgbList</td><td>A uint8_t array of pins (values are platform- dependent), 6X the prior rgbCount value, corresponding to the 6 output color bits for a matrix (or chain). Order is upper-half red, green, blue, lower-half red, green blue (repeat for each add'l chain). All the RGB pins (plus the clock pin below on some architectures) MUST be on the same PORT register. It's recommended (but not required) that all RGB pins (and clock depending on arch) be within the same byte of a PORT (but do not need to be sequential or contiguous within that byte) for more efficient RAM utilization. For two concurrent chains, same principle but 16-bit word. </td></tr>
    <tr><td class="paramname">addrCount</td><td>Number of row address lines required of matrix. Total pixel height is then 2 x 2^addrCount, e.g. 32-pixel-tall matrices have 4 row address lines. </td></tr>
    <tr><td class="paramname">addrList</td><td>A uint8_t array of pins (platform-dependent pin numbering), one per row address line. </td></tr>
    <tr><td class="paramname">clockPin</td><td>RGB clock pin (platform-dependent pin #). </td></tr>
    <tr><td class="paramname">latchPin</td><td>RGB data latch pin (platform-dependent pin #). </td></tr>
    <tr><td class="paramname">oePin</td><td>Output enable pin (platform-dependent pin #), active low. </td></tr>
    <tr><td class="paramname">doubleBuffer</td><td>If true, two matrix buffers are allocated, so changing display contents doesn't introduce artifacts mid-conversion. Requires ~2X RAM. </td></tr>
    <tr><td class="paramname">timer</td><td>Pointer to timer peripheral or timer-related struct (architecture-dependent), or NULL to use a default timer ID (also arch-dependent). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A ProtomatterStatus status, one of: PROTOMATTER_OK if everything is good. PROTOMATTER_ERR_PINS if data and/or clock pins are split across different PORTs. PROTOMATTER_ERR_MALLOC if insufficient RAM to allocate display memory. PROTOMATTER_ERR_ARG if a bad value (core or timer pointer) was passed in. </dd></dl>

</div>
</div>
<a id="abb36fc4f875be610434118739356fb5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb36fc4f875be610434118739356fb5c">&#9670;&nbsp;</a></span>_PM_begin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="core_8h.html#af659eb7a92f2ae47fac607db2eca4bc5">ProtomatterStatus</a> _PM_begin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate display buffers and populate additional elements of a Protomatter matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>Pointer to <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A ProtomatterStatus status, one of: PROTOMATTER_OK if everything is good. PROTOMATTER_ERR_PINS if data and/or clock pins are split across different PORTs. PROTOMATTER_ERR_MALLOC if insufficient RAM to allocate display memory. PROTOMATTER_ERR_ARG if a bad value. </dd></dl>

</div>
</div>
<a id="a98d7c90c3c5b83a38da3fd522f68abd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d7c90c3c5b83a38da3fd522f68abd7">&#9670;&nbsp;</a></span>_PM_stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _PM_stop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable (but do not deallocate) a Protomatter matrix. Disables matrix by setting OE pin HIGH and writing all-zero data to matrix shift registers, so it won't halt with lit LEDs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>Pointer to <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ace9b720e159e7ac6863915ee7e889768"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace9b720e159e7ac6863915ee7e889768">&#9670;&nbsp;</a></span>_PM_resume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _PM_resume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start or restart a matrix. Initialize counters, configure and start timer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>Pointer to <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adf89afcb7761b40e2cfa65a70bce5675"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf89afcb7761b40e2cfa65a70bce5675">&#9670;&nbsp;</a></span>_PM_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _PM_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate memory associated with <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure (e.g. screen data, pin lists for data and rows). Does not deallocate the structure itself. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>Pointer to <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abb462880fa61b8dcc1bee712a9be2f58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb462880fa61b8dcc1bee712a9be2f58">&#9670;&nbsp;</a></span>_PM_row_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _PM_row_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Matrix "row handler" that's called by the timer interrupt. Handles row address lines and issuing data to matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>Pointer to <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a00d7939d31d18e0763fcdf47ad5b298c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00d7939d31d18e0763fcdf47ad5b298c">&#9670;&nbsp;</a></span>_PM_getFrameCount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t _PM_getFrameCount </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_protomatter__core.html">Protomatter_core</a> *&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns current value of frame counter and resets its value to zero. Two calls to this, timed one second apart (or use math with other intervals), can be used to get a rough frames-per-second value for the matrix (since this is difficult to estimate beforehand). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>Pointer to <a class="el" href="struct_protomatter__core.html">Protomatter_core</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Frame count since previous call to function, as a uint32_t. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
